#include "main.h"
typedef unsigned char uint8;

#define DisplayClear	 				0x01
#define ReturnHome					0x02
#define EntryModeSet(RL,S)				(0x04|(RL<<1)|S)
#define DisplayControl(D,C,B)				(0x08|(D<<2)|(C<<1)|(B))
#define CursorDisplayControl(SC,RL)			(0x10|(SC<<3)|(RL<<2))
#define FunctionSet(DL,RE,G)				(0x20|(DL<<4)|(RE<<2)|(G<<1))
#define SetCGRAMAddress(x)				(0x40|x)
#define SetDDRAMAddress(x)				(0x80|x)

/*-------------------------------------------------------------------------------
 * NHD-14432WG
 * 144x32 Graphic LCD
 * pin1 = VSS
 * pin2 = VDD
 * pin3 = V0
 * pin4 = RS = P3.0
 * sig5 = RW = P3.7
 * pin6 = E = P3.4
 * pin7-14 = Data = P1
 * pin15,16 = BKL
-------------------------------------------------------------------------------*/
void SetData(uint8 Data){
}
void ResetPinRS(void){
}
void SetPinRS(void){
}
void ResetPinRW(void){
}
void SetPinRW(void){
}
void ResetPinE(void){
}
void SetPinE(void){
}

void mdelay(int ms){
    usleep(1000*ms);
}
void Wcom(uint8 A){
    printf("Wcom: %02X\n", A);
    SetData(A); 
    ResetPinRS();
    ResetPinRW();
    SetPinE(); 
    /* From NewHaven Offical Sample Code, and we don't know which P3.1. */
    /*
    Set P3.1
    Reset P3.1
    */
    ResetPinE();
}

void Wdata(uint8 A){
    //printf("Wdata: %02X\n", A);
    SetData(A);
    SetPinRS(); 
    ResetPinRW(); 
    SetPinE(); 
    /* From NewHaven Offical Sample Code, and we don't know which P3.1. */
    /*
    Set P3.1
    Reset P3.1
    */
    ResetPinE();
}
uint8 Img1[]={
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x33, 0x7F, 0x11, 0xE6, 0x38, 0xC6, 0xFB, 0x30, 0xF9, 0x9E, 0x7C, 0xC0, 0x71, 0x98, 0x00, 0x00,
    0x00, 0x00, 0x33, 0x63, 0x39, 0xE6, 0x38, 0xC6, 0xC3, 0x30, 0xCD, 0xB3, 0x66, 0xC0, 0x71, 0x98, 0x00, 0x00,
    0x00, 0x00, 0x3B, 0x61, 0xBB, 0x66, 0x6C, 0x6C, 0xC3, 0xB0, 0xCD, 0xB0, 0x66, 0xC0, 0xD8, 0x90, 0x00, 0x00,
    0x00, 0x00, 0x3B, 0x7D, 0xAB, 0x7E, 0x6C, 0x6C, 0xFB, 0xB0, 0xCD, 0xBC, 0x66, 0xC0, 0xD8, 0xF0, 0x00, 0x00,
    0x00, 0x00, 0x37, 0x61, 0xAB, 0x66, 0x6C, 0x6C, 0xC3, 0x70, 0xCD, 0x8F, 0x7C, 0xC0, 0xD8, 0x60, 0x00, 0x00,
    0x00, 0x00, 0x37, 0x61, 0xEF, 0x66, 0xFE, 0x6C, 0xC3, 0x70, 0xCD, 0x83, 0x60, 0xC1, 0xFC, 0x60, 0x00, 0x00,
    0x00, 0x00, 0x33, 0x60, 0xC6, 0x66, 0xC6, 0x38, 0xC3, 0x30, 0xCD, 0xB3, 0x60, 0xC1, 0x8C, 0x60, 0x00, 0x00,
    0x00, 0x00, 0x33, 0x7C, 0xC6, 0x66, 0xC6, 0x38, 0xFB, 0x30, 0xF9, 0x9E, 0x60, 0xFD, 0x8C, 0x60, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0xCC, 0xCC, 0xF8, 0x06, 0x0C, 0x33, 0xCF, 0x66, 0x67, 0x80, 0x18, 0xFC, 0xFD, 0x98, 0x31, 0x94, 0x00,
    0x00, 0xEC, 0xCC, 0xC4, 0x06, 0x1C, 0x76, 0x79, 0xE6, 0x6C, 0x60, 0x1C, 0x30, 0xC1, 0x98, 0x11, 0x14, 0x00,
    0x00, 0xEC, 0xCC, 0xC6, 0x1E, 0x2C, 0xB6, 0x79, 0xA6, 0x58, 0x60, 0x3C, 0x30, 0xC1, 0x98, 0x19, 0x14, 0x00,
    0x00, 0xEC, 0xFC, 0xC6, 0x06, 0x2C, 0xB0, 0x61, 0x35, 0x58, 0x00, 0x24, 0x30, 0xF9, 0xF8, 0x1B, 0x7E, 0x00,
    0x00, 0xDC, 0xCC, 0xC7, 0xC6, 0x4D, 0x31, 0xC3, 0x39, 0xD8, 0xEE, 0x66, 0x30, 0xC1, 0x9B, 0x8A, 0x24, 0x00,
    0x00, 0xDC, 0xCC, 0xC6, 0x06, 0x7F, 0xF8, 0x66, 0x19, 0x98, 0x60, 0x7E, 0x30, 0xC1, 0x98, 0x0A, 0x7E, 0x00,
    0x00, 0xCC, 0xCC, 0xCC, 0x06, 0x0C, 0x36, 0x6C, 0x19, 0x8C, 0x60, 0x42, 0x30, 0xC1, 0x98, 0x0E, 0x28, 0x00,
    0x00, 0xCC, 0xCC, 0xF8, 0x06, 0x0C, 0x33, 0xDF, 0x99, 0x87, 0xA0, 0xC3, 0x30, 0xC1, 0x98, 0x04, 0x28, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
}; 
void Show(void){
    int i=0, j=0;
    for(i=0; i<32; i++){
        //Wcom(0x3E); 
	Wcom(FunctionSet(1,1,1));
	Wcom(SetDDRAMAddress(i));
	Wcom(SetDDRAMAddress(0));
        for(j=0; j<18; j++){
            Wdata(Img1[18*i+j]); 
        }
    }
}
void DisplayOff(void){
    printf("%s, %d: \n", __FUNCTION__, __LINE__);
    Wcom(FunctionSet(1,0,0));
    Wcom(DisplayControl(0,0,0));
}
void Init(void){
    printf("%s, %d: \n", __FUNCTION__, __LINE__);
    int i=0, j=0;
    /*
    Wcom(0x38); 
    Wcom(0x0C); 
    Wcom(0x06); 
    Wcom(0x02); 
    Wcom(0x01); 
    */
    Wcom(FunctionSet(1,0,0));
    Wcom(DisplayControl(1,0,0));
    Wcom(EntryModeSet(1,0));
    Wcom(ReturnHome);
    Wcom(DisplayClear);
    mdelay(2);
    for(i=0; i<32; i++){
        //Wcom(0x3E); 
	Wcom(FunctionSet(1,1,1));
	Wcom(SetDDRAMAddress(i));
	Wcom(SetDDRAMAddress(0));
        for(j=0; j<36; j++){
            Wdata(0x00); 
        }
    }
}

void Info(void){
    printf("DisplayControl(D,C,B): D: %d, C: %d, B:%d, Value: 0x%02X\n", 1, 0, 0, DisplayControl(1,0,0));
    printf("FunctionSet(DL,RE,G): DL: %d, RE: %d, G:%d, Value: 0x%02X\n", 1, 1, 0, FunctionSet(1,1,0));
    printf("FunctionSet(DL,RE,G): DL: %d, RE: %d, G:%d, Value: 0x%02X\n", 1, 1, 1, FunctionSet(1,1,1)|0x8);
    printf("SetDDRAMAddress(3): 0x%02X\n", SetDDRAMAddress(3));
}

int main(int argc, char *argv[]){
    Info();
    Init();
    Show();
    DisplayOff();
    return 0; 
}

